(window.StoryblocksWebpackChunk=window.StoryblocksWebpackChunk||[]).push([[19],{100:function(e,t,n){},105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioPreviewEvent=void 0;const s=n(92);class o extends s.BaseAvroRecord{constructor(){super(...arguments),this.stockItemContext=null,this.drawerType=null}schema(){return o.schema}subject(){return o.subject}}t.AudioPreviewEvent=o,o.subject="audio-preview-event",o.schema={type:"record",name:"AudioPreviewEvent",namespace:"storyblocks.content",fields:[{name:"meta",type:{type:"record",name:"Meta",namespace:"storyblocks.common",fields:[{name:"uuid",type:"string"},{name:"emitted",type:{type:"long",logicalType:"timestamp-millis"}},{name:"origin",type:{type:"enum",name:"Origin",symbols:["VIDEOBLOCKS","AUDIOBLOCKS","GRAPHICSTOCK","STORYBLOCKS","STORYBLOCKS_NEXTJS","CONTRIBUTOR_PORTAL","TEMPLATE_EDITOR","ACCOUNT_SERVICE","BILLING_SERVICE","CONTENT_SERVICE","PAYOUT_SERVICE","TRANSLATION_SERVICE","CONTENT_RATING_APP","FEATURE_FLAG_SERVICE","PREMIERE_PRO_PLUGIN","AFTER_EFFECTS_PLUGIN","EXAMPLE_SERVICE","SEARCH_SERVICE","CONTENT_JOB","DATA_JOB","MISC","STORYBOARD","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"trace",type:["null",{type:"record",name:"TraceContext",fields:[{name:"traceId",type:"string"},{name:"pageTraceId",type:"string",default:""},{name:"spanId",type:"string"},{name:"parentId",type:"string",default:""}]}],default:null}]}},{name:"user",type:{type:"record",name:"User",namespace:"storyblocks.common",fields:[{name:"visitorCookieId",type:["null","string"]},{name:"userId",type:["null","int"]},{name:"subscriptionId",type:["null","int"]},{name:"organizationId",type:["null","int"],default:null}]}},{name:"urls",type:{type:"record",name:"Urls",namespace:"storyblocks.common",fields:[{name:"currentUrl",type:"string"},{name:"referrerUrl",type:["null","string"],default:null}]}},{name:"device",type:{type:"record",name:"Device",namespace:"storyblocks.common",fields:[{name:"browser",type:["null",{type:"record",name:"Browser",namespace:"storyblocks.common.frontend",fields:[{name:"userAgent",type:"string"},{name:"language",type:"string"},{name:"platform",type:"string"},{name:"name",type:"string"}]}],default:null},{name:"tab",type:["null",{type:"record",name:"Tab",namespace:"storyblocks.common.frontend",fields:[{name:"isNewTab",type:"boolean"},{name:"tabCount",type:"int"},{name:"tabId",type:"string"}]}],default:null},{name:"navigation",type:{type:"record",name:"Navigation",namespace:"storyblocks.common.frontend",fields:[{name:"referrerUrl",type:"string"},{name:"navigationType",type:["null",{type:"enum",name:"NavigationType",namespace:"storyblocks.common.enums",symbols:["TYPE_NAVIGATE","TYPE_RELOAD","TYPE_BACK_FORWARD","TYPE_RESERVED","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}],default:null}]}}]}},{name:"searchIdentifiers",type:{type:"record",name:"SearchIdentifiers",namespace:"storyblocks.search.records",fields:[{name:"searchId",type:"string",doc:"f.k.a. SSLID"},{name:"searchPageId",type:"string",doc:"f.k.a. SGUID"},{name:"lastSearchId",type:["null","string"],doc:"Previous searchId",default:null}]}},{name:"stockItem",type:{type:"record",name:"ShallowStockItem",namespace:"storyblocks.content.records",fields:[{name:"stockItemId",type:"int"},{name:"title",type:"string"},{name:"distributionType",type:{type:"enum",name:"DistributionType",namespace:"storyblocks.content.enums",symbols:["MEMBER_LIBRARY","REV_SHARE","MARKETPLACE","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"publishedDate",type:{type:"long",logicalType:"timestamp-millis"}},{name:"distributionTypeUpdatedDate",type:["null",{type:"long",logicalType:"timestamp-millis"}],default:null},{name:"contentType",type:{type:"enum",name:"ContentType",namespace:"storyblocks.content.enums",symbols:["ALL","LOOPS","MUSIC","SOUND_EFFECTS","ILLUSTRATIONS","PHOTOS","VECTORS","FOOTAGE","MOTION_BACKGROUNDS","TEMPLATES","VR_360","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"format",type:["null","string"],default:null},{name:"thumbnailUrl",type:["null","string"],default:null}]}},{name:"durationMs",type:"int"},{name:"playStartMs",type:"int",doc:"Relative to the beginning of the track."},{name:"playEndMs",type:"int",doc:"Relative to the beginning of the track."},{name:"stockItemContext",type:["null","string"],default:null},{name:"drawerType",type:["null","string"],default:null}]}},301:function(e,t,n){},80:function(e,t,n){"use strict";n(95),n(104),n(171),n(108),n(151),n(140),n(120),n(131),n(121),n(122),n(152),n(123),n(153)},83:function(e,t,n){"use strict";var s=n(0),o=n.n(s),i=n(1),r=n(105),a=n(19),c=n(110);class d{static create(e,t,n,s,o,i){const d=new r.AudioPreviewEvent;return d.meta=a.a.meta(),d.device=a.a.device(),d.user=a.a.user(),d.urls=a.a.urls(),d.searchIdentifiers=a.a.getSearchIdentifiers(),d.stockItem=c.a.create(e),d.durationMs=s,d.playStartMs=t,d.playEndMs=n,d.stockItemContext=o,d.drawerType=i,d}}var l=n(2),u=n(6),p=n(10),m=n(32),y=n(48),h=n(13),I=n(17);function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const T="pastVolume",E="currentVolume";class S extends s.Component{constructor(...e){super(...e),g(this,"audio",void 0),g(this,"state",{playStartMs:0,playEndMs:0}),g(this,"producePreviewEventIfPlaying",((e=null,t=null)=>{const n=e||this.props,s=t||this.state,o=null==n?void 0:n.stockItem,i=null==s?void 0:s.playStartMs,r=null==s?void 0:s.playEndMs,c=Math.round(1e3*n.duration),l=r-i,u=Math.min(c,1e3),p=n.stockItemContext,y=p===m.a.DRAWER?n.drawerType:null;if(!(!n.isPlaying||i>r||isNaN(c)||l<u))try{const e=d.create(o,i,r,c,p,y);a.a.produce(e,e.user.visitorCookieId)}catch(e){}}))}componentDidMount(){if("search"===this.props.context){const e=Object(y.a)(E),t=Object(y.a)(T);this.props.setPendingCurrentVolume(e),this.props.setPendingPastVolume(t)}this.audio.addEventListener("timeupdate",(()=>{this.setState({playEndMs:Math.round(1e3*this.audio.currentTime)}),this.props.setCurrentTime(this.audio.currentTime,this.audio.duration)})),this.audio.addEventListener("loadstart",(()=>{this.props.setAudioSource(this.audio.src)})),this.audio.addEventListener("seeking",(()=>{this.producePreviewEventIfPlaying(),this.setState({playStartMs:Math.round(1e3*this.audio.currentTime)})})),this.audio.addEventListener("playing",(()=>{this.props.playAudio()})),this.audio.addEventListener("pause",(()=>{this.producePreviewEventIfPlaying(),this.props.pauseAudio()})),this.audio.addEventListener("ended",(()=>{this.props.contentTypeFilter===p.c.MUSIC&&this.playNext()})),window.onbeforeunload=()=>this.producePreviewEventIfPlaying()}componentDidUpdate(e,t){let n=!1;null!==this.props.pendingCurrentVolume&&(Object(y.e)(E,this.props.pendingCurrentVolume),this.props.setAudioCurrentVolume(this.props.pendingCurrentVolume),this.audio.volume=this.props.pendingCurrentVolume,n=!0),null!==this.props.pendingPastVolume&&(Object(y.e)(T,this.props.pendingPastVolume),this.props.setAudioPastVolume(this.props.pendingPastVolume),n=!0),this.props.pendingAudioSourceUrl&&this.props.audioSourceUrl!==this.props.pendingAudioSourceUrl&&(this.audio.src=this.props.pendingAudioSourceUrl,n=!0),null!==this.props.pendingCurrentTime&&this.props.pendingCurrentTime>=0&&(this.audio.currentTime=this.props.pendingCurrentTime,n=!0),this.props.pendingShouldPlay&&(this.audio.play(),n=!0),this.props.pendingShouldPause&&(this.audio.pause(),n=!0),this.props.pendingPlayNext&&(this.playNext(),n=!0),this.props.pendingPlayPrev&&(this.playPrev(),n=!0),e.stockItem&&this.props.stockItem&&e.stockItem.id!==this.props.stockItem.id&&!1!==e.isPlaying&&this.producePreviewEventIfPlaying(e,t),n&&this.props.clearPendingAudioValues()}async playNext(){const{searchStockItems:e}=this.props;if(e.length){const e=this.determineQueuedTrack(1);await this.playQueuedTrack(e)}}async playPrev(){const{currentTime:e,stockItem:t,stockItemArtists:n,stockItemFormats:s,searchStockItems:o}=this.props;if(o.length){const o=e>=3?{stockItem:t,stockItemArtists:n,stockItemFormats:s}:this.determineQueuedTrack(-1);await this.playQueuedTrack(o)}}async playQueuedTrack(e){const{isLoggedIn:t}=this.props;let n={};try{const t=await fetch(e.stockItem.waveformUrl);n=await t.json()}catch(e){}this.props.setPendingPlayAudio(e.stockItem.previewUrl,0,e.stockItem,e.stockItemArtists,e.stockItemFormats,n),Object(y.d)(e.stockItem,t)}determineQueuedTrack(e){const{stockItem:t,filtersChanged:n}=this.props,s=this.getCombinedStockItems();if(n)return s[0];const o=s.findIndex((e=>e.stockItem.id===t.id));if(-1!==o){if(-1===e&&0===o)return s[o];const t=o+e;return t>=s.length?s[0]:s[t]}const i=s.findIndex((e=>e.stockItem.collapsedSetId===t.collapsedSetId));if(-1!==i){const t=i+e;return t>=s.length?s[0]:s[t]}return s[0]}getCombinedStockItems(){const{searchStockItems:e,collapsedSetStockItems:t,drawerIsOpen:n,drawerContentLoaded:s,drawerSelectedItemId:o}=this.props,i=[...e];if(n&&s&&o){const e=i.findIndex((e=>e.stockItem.id===o));i.splice(e+1,0,...t)}return i}render(){return o.a.createElement("audio",{id:"audio",ref:e=>this.audio=e},o.a.createElement("source",{type:"audio/mpeg",src:this.props.audioSourceUrl}))}}t.a=Object(i.b)((function(e){const t=Object(I.d)(e),{stockItem:n,stockItemArtists:s,stockItemFormats:o}=Object(I.c)(e),i=Object(l.y)(e);return{isPlaying:Object(I.k)(e),isPaused:Object(I.j)(e),audioSourceUrl:Object(I.f)(e),currentTime:Object(I.g)(e),duration:Object(I.i)(e),currentVolume:Object(I.h)(e),pastVolume:Object(I.l)(e),pendingCurrentVolume:t.currentVolume,pendingPastVolume:t.pastVolume,pendingMute:t.mute,pendingCurrentTime:t.currentTime,pendingAudioSourceUrl:t.audioSourceUrl,pendingShouldPlay:t.play,pendingShouldPause:t.pause,pendingPlayNext:t.playNext,pendingPlayPrev:t.playPrev,stockItem:n,stockItemArtists:s,stockItemFormats:o,searchStockItems:Object(l.N)(e),collapsedSetStockItems:Object(l.c)(e),isLoggedIn:Object(u.i)(e),drawerIsOpen:Object(l.g)(e),drawerContentLoaded:Object(l.f)(e),drawerSelectedItemId:Object(l.h)(e),drawerType:Object(l.i)(e),filtersChanged:Object(I.b)(e),context:Object(l.s)(e),contentTypeFilter:i.contentType,stockItemContext:Object(I.a)(e)}}),{setPendingCurrentVolume:h.l,setPendingPastVolume:h.m,setCurrentTime:h.j,setAudioSource:h.i,playAudio:h.e,pauseAudio:h.d,setAudioCurrentVolume:h.f,setAudioPastVolume:h.h,clearPendingAudioValues:h.c,setPendingPlayAudio:h.o})(S)},95:function(e,t,n){var s=function(e){return e.Local="local",e.Docker="docker",e.Staging="staging",e.Prod="prod",e}(s||{});const o={[s.Staging]:"d2mwnmk50ijuf9",[s.Prod]:"d3g7htsbjjywiv"},i=Object.keys(o).includes(__SITE_ENV__)?`${o[__SITE_ENV__]}.cloudfront.net`:window.location.hostname;n.p=`https://${i}/assets/build/`},99:function(e,t,n){}}]);